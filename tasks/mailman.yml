---

- name: "Mailman | Configure new maillist"
  command: echo {{ mailman_email }} | echo {{ mailman_password }} | newlist mailman

- name: "Mailman | Configure /etc/aliases"
  template:
    src: mailman.aliases
    dest: /etc/aliases

- name: "Mailman | Symlink"
  file:
    src: /etc/mailman/apache.conf
    dest: /etc/apache2/conf-enabled/mailman.conf
    state: link
    
- name: "Mailman | Ensure /var/lib/mailman/aliases exist"
  file:
    path: /var/lib/mailman/aliases
    state: touch

- name: "Mailman | newaliases"
  shell: newaliases

- name: "Mailman | Add mailman=yes to /etc/facts.conf"
  lineinfile:
    path: /etc/facts.conf
    state: present
    line: 'mailman=yes'
